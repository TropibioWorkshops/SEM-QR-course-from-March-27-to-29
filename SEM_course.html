<!DOCTYPE html>
<html lang="en"><head>
<script src="SEM_course_files/libs/clipboard/clipboard.min.js"></script>
<script src="SEM_course_files/libs/quarto-html/tabby.min.js"></script>
<script src="SEM_course_files/libs/quarto-html/popper.min.js"></script>
<script src="SEM_course_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="SEM_course_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SEM_course_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="SEM_course_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="28 March, 2023">
  <title>Introduction to SEM with lavaan</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="SEM_course_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="SEM_course_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="SEM_course_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="styles.css">
  <link href="SEM_course_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="SEM_course_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="SEM_course_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="SEM_course_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="SEM_course_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="SEM_course_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="Tropibio4.jpg" data-background-opacity="0.4" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title"><code>Introduction to SEM with lavaan</code></h1>
  <p class="subtitle"><code>Fernanda Alves Martins</code><br>
<code>Javier Martinez Arribas</code></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<code>28 March, 2023</code> 
</div>
</div>
</div>

</section>
<section id="section" class="slide level2">
<h2></h2>
</section>
<section id="structural-equation-modelling" class="slide level2">
<h2>Structural Equation Modelling</h2>
<div>
<p>Structural Equation Modeling (SEM) is a comprehensive and flexible approach that consists of studying, <u>in a hypothetical model</u>, the relationships between variables, whether they are measured or latent, meaning not directly observable, like any psychological construct (for example, intelligence, satisfaction, hope, trust).</p>
<p>Hypothetical because we try to predict and explain phenomena based on non-experimental observations.</p>
</div>
</section>
<section id="structural-equation-modelling-1" class="slide level2">
<h2>Structural Equation Modelling</h2>
<p>Structural equation modeling is a linear model framework that models both simultaneous regression equations with latent variables.</p>
<p>Models such as linear regression, multivariate regression, path analysis, confirmatory factor analysis, and structural regression can be thought of as special cases of SEM.</p>
</section>
<section id="structural-equation-modelling-2" class="slide level2">
<h2>Structural Equation Modelling</h2>
<div>
<p>The following relationships are possible in SEM:</p>
</div>
<div>
<ul>
<li class="fragment"><p>observed to observed variables (e.g.&nbsp;regression)</p></li>
<li class="fragment"><p>latent to observed variables (e.g.&nbsp;confirmatory factor analysis)</p></li>
<li class="fragment"><p>latent to latent variables (e.g.&nbsp;structural regression)</p></li>
</ul>
</div>
</section>
<section id="structural-equation-modelling-3" class="slide level2">
<h2>Structural Equation Modelling</h2>
<div>
<p>The most common models that fall under the SEM framework including</p>
<ul>
<li class="fragment"><p>simple regression</p></li>
<li class="fragment"><p>multiple regression</p></li>
<li class="fragment"><p>multivariate regression</p></li>
<li class="fragment"><p>path analysis</p></li>
<li class="fragment"><p>confirmatory factor analysis</p></li>
<li class="fragment"><p>structural regression</p></li>
</ul>
</div>
</section>
<section id="structural-equation-modelling-4" class="slide level2">
<h2>Structural Equation Modelling</h2>
<p>To summarize this brief introduction, it is important to recognize that interpreting correlation or partial correlation in terms of causality can be imprudent.</p>
<p>Mathematics alone cannot reveal the nature of the relationship between two variables, but can only indicate the extent to which they tend to vary together.</p>
</section>
<section id="structural-equation-modelling-5" class="slide level2">
<h2>Structural Equation Modelling</h2>
<div>
<p>As for the causality, it requires three criteria (or conditions):</p>
<ol type="1">
<li class="fragment"><p>the association rule, that is the two variables must be statistically associated.</p></li>
<li class="fragment"><p>the causal order between variables, the (quite often) temporal order where the cause precedes the effect must be determined without ambiguity and definitely with theoretical reasons that allow for assuming the order.</p></li>
<li class="fragment"><p>the non-artificiality rule, in which the association between the two variables must not disappear when we remove the effects of variables that precede them in the causal order.</p></li>
</ol>
</div>
</section>
<section id="structural-equation-modelling-6" class="slide level2">
<h2>Structural Equation Modelling</h2>
<p>It is evident that meeting these three criteria is only achievable through experimentation, limited by what is feasible and conceivable.</p>
<p>It should be noted that no matter how advanced or intelligent a statistical technique may be, such as analysis of variance, regression, or path analysis, it cannot establish a causal relationship between variables.</p>
</section>
<section id="definitions" class="slide level2">
<h2>Definitions</h2>
<div>
<ul>
<li class="fragment"><p>observed variable: a variable that exists in the data, a.k.a item or manifest variable</p></li>
<li class="fragment"><p>latent variable: a variable that is constructed and does not exist in the data</p></li>
<li class="fragment"><p>exogenous variable: an independent variable either observed (x) or latent ( ) that explains an endogenous variable</p></li>
<li class="fragment"><p>endogenous variable: a dependent variable, either observed (y) or latent ( ) that has a causal path leading to it</p></li>
</ul>
</div>
</section>
<section id="definitions-1" class="slide level2">
<h2>Definitions</h2>
<div>
<ul>
<li class="fragment"><p>measurement model: a model that links observed variables with latent variables</p></li>
<li class="fragment"><p>indicator: an observed variable in a measurement model (can be exogenous or endogenous)</p></li>
<li class="fragment"><p>factor: a latent variable defined by its indicators (can be exogenous or endogenous)</p></li>
<li class="fragment"><p>loading: a path between an indicator and a factor</p></li>
</ul>
</div>
</section>
<section id="definitions-2" class="slide level2">
<h2>Definitions</h2>
<div>
<ul>
<li class="fragment"><p>structural model: a model that specifies causal relationships among exogenous variables to endogenous variables (can be observed or latent)</p></li>
<li class="fragment"><p>regression path: a path between exogenous and endogenous variables (can be observed or latent)</p></li>
</ul>
</div>
</section>
<section id="path-diagram-legend" class="slide level2">
<h2>Path Diagram Legend</h2>
<p>In order to make it easier to comprehend the matrix equations, a path diagram will be provided for each matrix formulation, as it serves as a symbolic and straightforward visualization tool.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Path_diagram.png" width="300" height="300"></p>
</figure>
</div>
</section>
<section id="examples-of-sem-models" class="slide level2">
<h2>Examples of SEM models</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Regression.png" width="300" height="150"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SEM.png" width="600" height="300"></p>
</figure>
</div>
</section>
<section id="linear-regression-diagram" class="slide level2">
<h2>Linear regression diagram</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Regresion.png" width="900" height="500"></p>
<p></p><figcaption>Regression model diagram</figcaption><p></p>
</figure>
</div>
</section>
<section id="setting-up" class="slide level2">
<h2>Setting up</h2>
<p>Firstly we need to install the next packages:</p>
<p><code>lavaan</code> and <code>semPlot</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">install.packages</span>(<span class="st">"semPlot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then load with <code>library()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(semPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-data" class="slide level2">
<h2>Example Data</h2>
<p>We will utilize the sample data integrated into <code>lavaan</code> to examine its syntax and output.</p>
<p>Our example uses a classic data set from the literature on the testing of mental abilities.<br>
The Holzinger and Swineford (1939) data set contains test scores from around 300 teenagers at two different schools, each of whom completed a series of tests measuring performance for different tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">data</span>(HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-data-1" class="slide level2">
<h2>Example Data</h2>
<p>We can summarise the relationships between the variables by generating a covariance matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">round</span>(<span class="fu">cov</span>(HolzingerSwineford1939[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>]),<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x1    x2   x3   x4   x5   x6    x7   x8   x9
x1 1.36  0.41 0.58 0.51 0.44 0.46  0.09 0.26 0.46
x2 0.41  1.39 0.45 0.21 0.21 0.25 -0.10 0.11 0.24
x3 0.58  0.45 1.28 0.21 0.11 0.24  0.09 0.21 0.38
x4 0.51  0.21 0.21 1.36 1.10 0.90  0.22 0.13 0.24
x5 0.44  0.21 0.11 1.10 1.67 1.02  0.14 0.18 0.30
x6 0.46  0.25 0.24 0.90 1.02 1.20  0.14 0.17 0.24
x7 0.09 -0.10 0.09 0.22 0.14 0.14  1.19 0.54 0.37
x8 0.26  0.11 0.21 0.13 0.18 0.17  0.54 1.03 0.46
x9 0.46  0.24 0.38 0.24 0.30 0.24  0.37 0.46 1.02</code></pre>
</div>
</div>
</section>
<section id="example-data-2" class="slide level2">
<h2>Example Data</h2>
<p>It can be more helpful to look at the correlation matrix, which is a standardised version of the covariance matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(HolzingerSwineford1939[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>]),<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x1    x2   x3   x4   x5   x6    x7   x8   x9
x1 1.00  0.30 0.44 0.37 0.29 0.36  0.07 0.22 0.39
x2 0.30  1.00 0.34 0.15 0.14 0.19 -0.08 0.09 0.21
x3 0.44  0.34 1.00 0.16 0.08 0.20  0.07 0.19 0.33
x4 0.37  0.15 0.16 1.00 0.73 0.70  0.17 0.11 0.21
x5 0.29  0.14 0.08 0.73 1.00 0.72  0.10 0.14 0.23
x6 0.36  0.19 0.20 0.70 0.72 1.00  0.12 0.15 0.21
x7 0.07 -0.08 0.07 0.17 0.10 0.12  1.00 0.49 0.34
x8 0.22  0.09 0.19 0.11 0.14 0.15  0.49 1.00 0.45
x9 0.39  0.21 0.33 0.21 0.23 0.21  0.34 0.45 1.00</code></pre>
</div>
</div>
</section>
<section id="example-data-3" class="slide level2">
<h2>Example Data</h2>
<p>It can be more helpful to look at the correlation matrix, which is a standardised version of the covariance matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">pairs</span>(HolzingerSwineford1939[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">cex =</span> .<span class="dv">25</span>,<span class="at">main=</span><span class="st">"Scatterplots"</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="example-data-4" class="slide level2">
<h2>Example Data</h2>
<p>The correlation matrix displays predominantly positive associations between various variable combinations, with the highest correlation (r = 0.73) observed between x4 and x5, which refer to paragraph comprehension and sentence completion tasks.</p>
<p>Notably, a cluster of high correlations is centered around x4, x5, and x6.</p>
<p>Nevertheless, merely by examining the correlation matrix, it proves difficult to comprehend the data setâ€™s structure.</p>
<p>Alternatively, a hypothetical model can be constructed to depict the potential relationships.</p>
</section>
<section id="lavaan-syntax-operators" class="slide level2">
<h2>lavaan Syntax: Operators</h2>
<div>
<p><code>lavaan</code> uses a simplified syntax using three primary operators:</p>
<ul>
<li class="fragment"><code>~</code> for regressions</li>
<li class="fragment"><code>=~</code> for latent variables</li>
<li class="fragment"><code>~~</code> for variances and covariances</li>
</ul>
</div>
<p>Every model will be specified with <em>strings of text</em> containing some combination of these three operators.</p>
</section>
<section id="lavaan-syntax-functions" class="slide level2">
<h2>lavaan Syntax: Functions</h2>
<div>
<p><code>lavaan</code> uses three primary functions for estimating models:</p>
<ul>
<li class="fragment"><code>cfa()</code> for Confirmatory Factor Analysis</li>
<li class="fragment"><code>sem()</code> for Structural Equation Models</li>
<li class="fragment"><code>lavaan()</code> for <em>all</em> models.</li>
</ul>
</div>
<p>To view the default arguments for each function, you can access the help documentation.(<code>?cfa</code>)</p>
<p>It is normal to utilize <code>sem()</code> for all my analyses as I am accustomed to its default settings and usually estimate traditional structural equation models.</p>
</section>
<section id="linear-regression" class="slide level2">
<h2>Linear regression</h2>
<p>It is highly likely that most, if not all of you, are familiar with how to specify a linear regression in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(x4 <span class="sc">~</span> ageyr, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can specify a simple linear regression in <code>lavaan</code> similarly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>sem_1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="st">'x4 ~ ageyr'</span>, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This syntax specifies that <code>x4</code> is regressed on <code>ageyr</code>, with the dependent variable placed on the left of <code>~</code> and the independent variable(s) on the right.</p>
<p>Note the formulas for <code>lavaan</code> calls are <em>in quotes</em>:<br>
<code>lavaan</code> requires text input, which it converts into individual equations internally.</p>
</section>
<section id="linear-regression-1" class="slide level2">
<h2>Linear regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">summary</span>(lm_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = x4 ~ ageyr, data = HolzingerSwineford1939)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.94620 -0.72685 -0.06018  0.60649  3.15918 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.91179    0.81917   7.217 4.41e-12 ***
ageyr       -0.21935    0.06282  -3.492 0.000553 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.143 on 299 degrees of freedom
Multiple R-squared:  0.03917,   Adjusted R-squared:  0.03596 
F-statistic: 12.19 on 1 and 299 DF,  p-value: 0.0005527</code></pre>
</div>
</div>
</section>
<section id="linear-regression-2" class="slide level2">
<h2>Linear regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">summary</span>(sem_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         2

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  x4 ~                                                
    ageyr            -0.219    0.063   -3.503    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x4                1.298    0.106   12.268    0.000</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="slide level2">
<h2>Multiple linear regression</h2>
<p>We can specify multiple regression models by including additional covariates on the right-hand side of the formulas.</p>
<p>In <code>lm()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>lm_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(x4 <span class="sc">~</span> ageyr <span class="sc">+</span> sex <span class="sc">+</span> grade, </span>
<span id="cb15-2"><a href="#cb15-2"></a>               <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <code>sem()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sem_2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="st">'x4 ~ ageyr + sex + grade'</span>, </span>
<span id="cb16-2"><a href="#cb16-2"></a>                 <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cfa" class="slide level2">
<h2>CFA</h2>
<p>Factor analysis can be categorized into two primary types: exploratory and confirmatory.</p>
<p><br>
<strong>Exploratory factor analysis</strong> (EFA) is an exploratory technique used to comprehend the underlying psychometric characteristics of an unfamiliar scale.</p>
<p><br>
In contrast, <strong>confirmatory factor analysis</strong> shares many of the same principles as EFA, but instead of allowing the data to reveal the factor structure, we pre-specify the factor structure and validate the psychometric properties of a pre-existing scale.</p>
</section>
<section id="cfa-1" class="slide level2">
<h2>CFA</h2>
<p>We can construct a first hypothetical model of the potential relationships.</p>
<p>One very simple model is that a single underlying factor determines performance on all tasks.</p>
<p>This general intelligence, or g, factor is widely discussed in the literature on human cognitive ability (Spearman 1904).</p>
<p>It is the classic example of a latent variable - a construct that we hypothesise might exist, but we cannot measure directly.</p>
</section>
<section id="cfa-2" class="slide level2">
<h2>CFA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>cfa_0 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">   g  =~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">'</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>cfa_0 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_0, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cfa-3" class="slide level2">
<h2>CFA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">summary</span>(cfa_0, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 31 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                               312.264
  Degrees of freedom                                27
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.677
  Tucker-Lewis Index (TLI)                       0.569

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3851.224
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7738.448
  Bayesian (BIC)                              7805.176
  Sample-size adjusted Bayesian (BIC)         7748.091

Root Mean Square Error of Approximation:

  RMSEA                                          0.187
  90 Percent confidence interval - lower         0.169
  90 Percent confidence interval - upper         0.206
  P-value RMSEA &lt;= 0.05                          0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.143

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g =~                                                                  
    x1                1.000                               0.510    0.438
    x2                0.508    0.152    3.345    0.001    0.259    0.220
    x3                0.493    0.146    3.376    0.001    0.252    0.223
    x4                1.930    0.256    7.533    0.000    0.985    0.848
    x5                2.123    0.282    7.518    0.000    1.084    0.841
    x6                1.796    0.239    7.512    0.000    0.917    0.838
    x7                0.385    0.137    2.803    0.005    0.196    0.180
    x8                0.398    0.129    3.089    0.002    0.203    0.201
    x9                0.606    0.138    4.383    0.000    0.309    0.307

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                1.098    0.092   11.895    0.000    1.098    0.808
   .x2                1.315    0.108   12.188    0.000    1.315    0.951
   .x3                1.212    0.099   12.186    0.000    1.212    0.950
   .x4                0.380    0.048    7.963    0.000    0.380    0.281
   .x5                0.486    0.059    8.193    0.000    0.486    0.293
   .x6                0.356    0.043    8.295    0.000    0.356    0.298
   .x7                1.145    0.094   12.215    0.000    1.145    0.967
   .x8                0.981    0.080   12.202    0.000    0.981    0.960
   .x9                0.919    0.076   12.105    0.000    0.919    0.906
    g                 0.261    0.069    3.775    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="cfa-4" class="slide level2">
<h2>CFA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">semPaths</span>(cfa_0,<span class="at">layout=</span><span class="st">"circle"</span>,<span class="at">whatLabels=</span><span class="st">"stand"</span>,<span class="at">edge.label.cex=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="cfa-5" class="slide level2">
<h2>CFA</h2>
<p>An alternative model might be to propose that there are several latent variables, which map on to specific abilities that are probed by more than one test.</p>
<p>For example, we might propose a latent variable for the visual tasks (x1-x3), another for the literacy tasks (x4-x6) and a final one for the timed tasks (x7-x9). We could allow interdependencies (i.e.&nbsp;correlations) between these three latent variables, and represent the model with the diagram in Figure 12.3.</p>
<p>We are going to define three latent (unobserved) variables, <code>visual</code>, <code>textual</code>, and <code>speed</code>, each with three observed indicators.</p>
</section>
<section id="cfa-6" class="slide level2">
<h2>CFA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>cfa_1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">   visual  =~ x1 + x2 + x3</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">   textual =~ x4 + x5 + x6</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">   speed   =~ x7 + x8 + x9</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="st">'</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>cfa_1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_1, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cfa-7" class="slide level2">
<h2>CFA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">summary</span>(cfa_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2                0.554    0.100    5.554    0.000
    x3                0.729    0.109    6.685    0.000
  textual =~                                          
    x4                1.000                           
    x5                1.113    0.065   17.014    0.000
    x6                0.926    0.055   16.703    0.000
  speed =~                                            
    x7                1.000                           
    x8                1.180    0.165    7.152    0.000
    x9                1.082    0.151    7.155    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.408    0.074    5.552    0.000
    speed             0.262    0.056    4.660    0.000
  textual ~~                                          
    speed             0.173    0.049    3.518    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.549    0.114    4.833    0.000
   .x2                1.134    0.102   11.146    0.000
   .x3                0.844    0.091    9.317    0.000
   .x4                0.371    0.048    7.779    0.000
   .x5                0.446    0.058    7.642    0.000
   .x6                0.356    0.043    8.277    0.000
   .x7                0.799    0.081    9.823    0.000
   .x8                0.488    0.074    6.573    0.000
   .x9                0.566    0.071    8.003    0.000
    visual            0.809    0.145    5.564    0.000
    textual           0.979    0.112    8.737    0.000
    speed             0.384    0.086    4.451    0.000</code></pre>
</div>
</div>
</section>
<section id="cfa-8" class="slide level2">
<h2>CFA</h2>
<p>The larger the chi-square value the larger the difference between the sample implied covariance matrix and the sample observed covariance matrix, and the more likely you will reject your model.</p>
<p>David Kenny states that for models with 75 to 200 cases chi-square is a reasonable measure of fit, but for 400 cases or more it is nearly almost always significant.</p>
<p>Our conclusion may be supplemented with other fit indices.</p>
</section>
<section id="semplot-diagram" class="slide level2">
<h2>semPlot diagram</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">semPaths</span>(cfa_1, <span class="at">whatLabels =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="step-1-model-specification" class="slide level2">
<h2>STEP 1: model specification</h2>
<p>This is what we have done just done. We consider the possible relationships between the variables we have measured (or are planning to measure), and one or more hypothesised latent variables.</p>
<p>It can often be helpful to create diagrams when designing a model, as a guide to thinking about possible relationships.<br>
This is one of the real strengths of structural equation modelling, as it allows us to make theories and hypotheses explicit by instantiating them in a model, which we then go on to test empirically.</p>
</section>
<section id="step-2-model-identification" class="slide level2">
<h2>STEP 2: model identification</h2>
<p>Once we have specified our model, we then check that it is suitable for conducting SEM.</p>
<p>This involves a process called model identification, where we check that the degrees of freedom in the model (known as the number of free parameters) does not exceed the degrees of freedom in the data set (known as the number of data points). We can have the next different models:</p>
<ul>
<li class="fragment"><p>Satured models: nÂº data points = free parameters</p></li>
<li class="fragment"><p>Under-identified models: nÂº data points &lt; free parameters</p></li>
<li class="fragment"><p>Over-identified models: nÂº data points &gt; free parameters</p></li>
</ul>
</section>
<section id="step-2-model-identification-1" class="slide level2">
<h2>STEP 2: model identification</h2>
<div class="{incremental}">
<ul>
<li class="fragment"><p>degrees of freedom in the data set (known parameters): n(n+1)/2. Serve as the upper limit of the number of parameters you can possibly estimate in your model.</p></li>
<li class="fragment"><p>degrees of freedom in the model (model parameters): the number of parameters you need to estimate in your model. (The total number of latent variables + the number of error terms on the measured variables + any covariances between measured variables)</p></li>
</ul>
</div>
</section>
<section id="step-3-model-evaluation" class="slide level2">
<h2>STEP 3: model evaluation</h2>
<p>Once fitted, the model is traditionally assessed using a chi-square statistic. Somewhat counterintuitively, a non-significant chi-square statistic indicates a good fit.</p>
<p>However, as with other significancetests, this turns out to be highly dependent on sample size and with large samples (e.g.&nbsp;N&gt;400) will often be statistically significant even when the model fit is actually quite good.</p>
<p>To address this, several alternative fit indices have been developed. Some of these (for example, the Bentler-Bonett index, Comparative fit index, Bollen index, and McDonald index) indicate a good fit when they have values near 1.</p>
</section>
<section id="step-3-model-evaluation-1" class="slide level2">
<h2>STEP 3: model evaluation</h2>
<p>Conventions about exactly what values are considered â€˜goodâ€™ will differ across disciplines, but 0.9 is often acceptable.</p>
<p>For other fit estimates, such as the Root Mean Square Error or measures of residual variance, a low value near 0 indicates a good fit.</p>
</section>
<section id="model-fit-statistics" class="slide level2">
<h2>Model Fit Statistics</h2>
<p>Typically, rejecting the null hypothesis is a good thing, but if we reject the CFA null hypothesis then we would reject our user model (which is bad).</p>
<p>When fit measures are requested, lavaan outputs a plethora of statistics, but we will focus on the four commonly used ones:</p>
<div>
<ul>
<li class="fragment"><p>Model chi-square is the chi-square statistic we obtain from the maximum likelihood statistic (in lavaan, this is known as the Test Statistic for the Model Test User Model)</p></li>
<li class="fragment"><p>CFI is the Comparative Fit Index â€“ values can range between 0 and 1 (values greater than 0.90, conservatively 0.95 indicate good fit)</p></li>
</ul>
</div>
</section>
<section id="model-fit-statistics-1" class="slide level2">
<h2>Model Fit Statistics</h2>
<div>
<ul>
<li class="fragment"><p>TLI Tucker Lewis Index which also ranges between 0 and 1 (if itâ€™s greater than 1 it should be rounded to 1) with values greater than 0.90 indicating good fit. If the CFI and TLI are less than one, the CFI is always greater than the TLI.</p></li>
<li class="fragment"><p>RMSEA is the root mean square error of approximation In lavaan, you also obtain a p-value of close fit, that the RMSEA &lt; 0.05. If you reject the model, it means your model is not a close fitting model.</p></li>
</ul>
</div>
</section>
<section id="model-fit-statistics-2" class="slide level2">
<h2>Model Fit Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">summary</span>(cfa_1, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (BIC)         7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value RMSEA &lt;= 0.05                          0.001

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                1.000                               0.900    0.772
    x2                0.554    0.100    5.554    0.000    0.498    0.424
    x3                0.729    0.109    6.685    0.000    0.656    0.581
  textual =~                                                            
    x4                1.000                               0.990    0.852
    x5                1.113    0.065   17.014    0.000    1.102    0.855
    x6                0.926    0.055   16.703    0.000    0.917    0.838
  speed =~                                                              
    x7                1.000                               0.619    0.570
    x8                1.180    0.165    7.152    0.000    0.731    0.723
    x9                1.082    0.151    7.155    0.000    0.670    0.665

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.408    0.074    5.552    0.000    0.459    0.459
    speed             0.262    0.056    4.660    0.000    0.471    0.471
  textual ~~                                                            
    speed             0.173    0.049    3.518    0.000    0.283    0.283

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.549    0.114    4.833    0.000    0.549    0.404
   .x2                1.134    0.102   11.146    0.000    1.134    0.821
   .x3                0.844    0.091    9.317    0.000    0.844    0.662
   .x4                0.371    0.048    7.779    0.000    0.371    0.275
   .x5                0.446    0.058    7.642    0.000    0.446    0.269
   .x6                0.356    0.043    8.277    0.000    0.356    0.298
   .x7                0.799    0.081    9.823    0.000    0.799    0.676
   .x8                0.488    0.074    6.573    0.000    0.488    0.477
   .x9                0.566    0.071    8.003    0.000    0.566    0.558
    visual            0.809    0.145    5.564    0.000    1.000    1.000
    textual           0.979    0.112    8.737    0.000    1.000    1.000
    speed             0.384    0.086    4.451    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="model-fit-statistics-3" class="slide level2">
<h2>Model Fit Statistics</h2>
<p>The three subsequent sections of the output report additional measures of goodness of fit, including the log likelihood, the Akaike Information Criterion, the Bayesian Information criterion, and the root mean square (RMS) error.</p>
<p>These values are particularly useful for comparing between different possible models.</p>
</section>
<section id="model-fit-statistics-4" class="slide level2">
<h2>Model Fit Statistics</h2>
<p>The final sections of the output show parameter estimates for the latent variables, covariances and variances.</p>
<p>These are somewhat difficult to interpret in table format, so we can add the parameter estimates to the path diagram to give a numerical indication of the strength of the links between variables.</p>
<p>This can be done using standardised or unstandardised values.</p>
<p>In general, standardised values are more useful, as the values are then similar to correlation coefficients.</p>
<p>The fitted parameters show high loading of individual measures onto the latent variables (coefficients between 0.40 and 0.80).</p>
</section>
<section id="step-4-model-modification" class="slide level2">
<h2>STEP 4: model modification</h2>
<p>The final stage of SEM is to consider possible modifications to the model that might improve its description of the data. To do this, parameters can be added or removed (or both).</p>
<p>The change in fit when parameters are added is assessed by the Lagrange Multiplier test (sometimes called the score test).</p>
<p>These procedures are conceptually similar to step-wise and backward step-wise entry of predictors in multiple regression, and come with similar pitfalls.</p>
</section>
<section id="step-4-model-modification-1" class="slide level2">
<h2>STEP 4: model modification</h2>
<p>Adding many new parameters at once is not advisable, as the parameters may be highly correlated (and therefore not very informative).</p>
<p>The order in which parameters are added and removed can also affect the outcome, so care is advised when attempting changes to the model.</p>
</section>
<section id="step-4-model-modification-2" class="slide level2">
<h2>STEP 4: model modification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">modindices</span>(cfa_1, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>mi[mi<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"=~"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op rhs     mi
30  visual =~  x9 36.411
28  visual =~  x7 18.631
33 textual =~  x3  9.151
31 textual =~  x1  8.903
26  visual =~  x5  7.441
36 textual =~  x9  4.796
29  visual =~  x8  4.295
35 textual =~  x8  3.359
27  visual =~  x6  2.843
38   speed =~  x2  1.580
25  visual =~  x4  1.211
39   speed =~  x3  0.716
42   speed =~  x6  0.273
41   speed =~  x5  0.201
34 textual =~  x7  0.098
32 textual =~  x2  0.017
37   speed =~  x1  0.014
40   speed =~  x4  0.003</code></pre>
</div>
</div>
</section>
<section id="step-4-model-modification-3" class="slide level2">
<h2>STEP 4: model modification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>cfa_2<span class="ot">&lt;-</span> <span class="st">' </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  visual =~ x1 + x2 + x3 + x9</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="st">  speed =~ x7 + x8 + x9 </span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="st">'</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>cfa_2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_2, <span class="at">data =</span> HolzingerSwineford1939)</span>
<span id="cb29-7"><a href="#cb29-7"></a></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="fu">semPaths</span>(cfa_2,<span class="at">layout=</span><span class="st">"circle"</span>,<span class="at">whatLabels=</span><span class="st">"stand"</span>,<span class="at">edge.label.cex=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="step-4-model-modification-4" class="slide level2">
<h2>STEP 4: model modification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lavTestScore</span>(cfa_1, <span class="at">add =</span> <span class="st">'visual =~ x9'</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>a<span class="sc">$</span>uni</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
univariate score tests:

         lhs op rhs     X2 df p.value
1 visual=~x9 ==   0 36.411  1       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">fitmeasures</span>(cfa_1,<span class="st">'rmsea'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rmsea 
0.092 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">fitmeasures</span>(cfa_2,<span class="st">'rmsea'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rmsea 
0.065 </code></pre>
</div>
</div>
</section>
<section id="step-4-model-modification-5" class="slide level2">
<h2>STEP 4: model modification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>cfa_3 <span class="ot">&lt;-</span> <span class="st">' </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  visual =~ x1 + b1*x2 + x3</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="st">  speed =~ x7 + x8 + x9 '</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>cfa_3 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_3, <span class="at">data =</span> HolzingerSwineford1939)</span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="fu">lavTestWald</span>(cfa_3, <span class="at">constraints =</span> <span class="st">'b1 == 0'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 30.84248

$df
[1] 1

$p.value
[1] 2.79844e-08

$se
[1] "standard"</code></pre>
</div>
</div>
</section>
<section id="step-4-model-modification-6" class="slide level2">
<h2>STEP 4: model modification</h2>
<p>The Wald test also produces a significant p-value, suggesting this change to the model should be investigated more thoroughly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">fitmeasures</span>(cfa_3,<span class="st">'rmsea'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rmsea 
0.092 </code></pre>
</div>
</div>
<p>However, on further inspection, it actually produces a larger RMS error (and therefore a worse fit) than our original model.</p>
</section>
<section id="caveats-cross-validation" class="slide level2">
<h2>CAVEATS: Cross-validation</h2>
<p>One thing to worry about in SEM is making sure that the model works for more than just the data it was made for.</p>
<p>If the data set is large enough, we might split the data in two (male and female is sometimes used, assuming these are expected involve the same relationships between variables), fit the model to the two data sets separately, and then compare the model parameters (coefficient estimates) to check that they are similar.</p>
</section>
<section id="caveats-power-and-sem" class="slide level2">
<h2>CAVEATS: Power and SEM</h2>
<p>SEM is a large sample size technique, and parameter estimates will only be stable with N&gt;200 participants. A further standard recommendation is to test at least 5 (and ideally 10) participants per measured variable (while still requiring at least 200 observations). This is because the parameters we are estimating are effectively correlation coefficients, and these are very hard to estimate precisely with small sample sizes.</p>
</section>
<section id="caveats-missing-data" class="slide level2">
<h2>CAVEATS: Missing Data</h2>
<p>One issue that can dramatically reduce power is when observations are missing from a data set. If we excluded all participants with at least one missing data point, for some data sets this would substantially decrease the overall sample size. To avoid this situation, it is common practise to replace missing data points with an estimated value. This maintains the sample size and keeps the model as robust as possible. A simple method to do this is to replace a missing data point with the mean score for that variable.</p>
</section>
<section id="other-models-walking-dog" class="slide level2">
<h2>Other models: Walking dog</h2>
<p>A popular example of a SEM is the walking dog model, which comprises of two latent variables, both with two indicators, and a regression connecting them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>wd_1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">   X =~ x1 + x2</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">   Y =~ x4 + x5</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">   Y ~ X</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="st">'</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>wd_1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(wd_1, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="walking-dog" class="slide level2">
<h2>Walking dog</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">summary</span>(wd_1, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 32 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                 0.252
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.616

Model Test Baseline Model:

  Test statistic                               306.333
  Degrees of freedom                                 6
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.015

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1771.622
  Loglikelihood unrestricted model (H1)      -1771.496
                                                      
  Akaike (AIC)                                3561.244
  Bayesian (BIC)                              3594.608
  Sample-size adjusted Bayesian (BIC)         3566.065

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.121
  P-value RMSEA &lt;= 0.05                          0.728

Standardized Root Mean Square Residual:

  SRMR                                           0.005

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  X =~                                                                  
    x1                1.000                               0.984    0.844
    x2                0.421    0.150    2.811    0.005    0.414    0.352
  Y =~                                                                  
    x4                1.000                               1.117    0.961
    x5                0.880    0.116    7.571    0.000    0.983    0.763

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Y ~                                                                   
    X                 0.521    0.181    2.876    0.004    0.459    0.459

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.390    0.325    1.201    0.230    0.390    0.287
   .x2                1.210    0.114   10.617    0.000    1.210    0.876
   .x4                0.103    0.153    0.676    0.499    0.103    0.077
   .x5                0.694    0.131    5.292    0.000    0.694    0.418
    X                 0.969    0.340    2.849    0.004    1.000    1.000
   .Y                 0.985    0.192    5.134    0.000    0.789    0.789</code></pre>
</div>
</div>
</section>
<section id="semplot-diagram-1" class="slide level2">
<h2>semPlot diagram</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">semPaths</span>(wd_1, <span class="at">whatLabels =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section>
<section id="other-models-fixing-covariances" class="slide level2">
<h2>Other models: Fixing covariances</h2>
<p>We can also constrain covariances to <code>0</code> with the same basic syntax.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>cfa_4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="st">   visual  =~ x1 + x2 + x3</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">   textual =~ x4 + x5 + x6</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="st">   speed   =~ x7 + x8 + x9</span></span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="st">   visual  ~~ 0*textual + 0*speed</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="st">'</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>cfa_4 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_4, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For covariances, you can have only one variable left of <code>~~</code> but multiple on the right.</p>
<p>Here we have made the assumption that the <code>visual</code> latent construct is <strong>orthogonal</strong> to <code>textual</code> and <code>speed</code>.</p>
</section>
<section id="other-models-fixing-covariances-1" class="slide level2">
<h2>Other models: Fixing covariances</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(cfa_4, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 33 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                               140.599
  Degrees of freedom                                26
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.870
  Tucker-Lewis Index (TLI)                       0.820

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3765.392
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7568.783
  Bayesian (BIC)                              7639.218
  Sample-size adjusted Bayesian (BIC)         7578.961

Root Mean Square Error of Approximation:

  RMSEA                                          0.121
  90 Percent confidence interval - lower         0.102
  90 Percent confidence interval - upper         0.141
  P-value RMSEA &lt;= 0.05                          0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.145

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                1.000                               0.724    0.621
    x2                0.778    0.141    5.532    0.000    0.563    0.479
    x3                1.107    0.214    5.173    0.000    0.801    0.710
  textual =~                                                            
    x4                1.000                               0.984    0.847
    x5                1.132    0.067   16.954    0.000    1.114    0.865
    x6                0.925    0.056   16.438    0.000    0.911    0.833
  speed =~                                                              
    x7                1.000                               0.674    0.619
    x8                1.150    0.165    6.990    0.000    0.775    0.766
    x9                0.878    0.123    7.166    0.000    0.592    0.587

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
  textual ~~                                                            
    speed             0.173    0.052    3.331    0.001    0.261    0.261

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.835    0.118    7.064    0.000    0.835    0.614
   .x2                1.065    0.105   10.177    0.000    1.065    0.771
   .x3                0.633    0.129    4.899    0.000    0.633    0.496
   .x4                0.382    0.049    7.854    0.000    0.382    0.283
   .x5                0.418    0.059    7.113    0.000    0.418    0.252
   .x6                0.367    0.044    8.374    0.000    0.367    0.307
   .x7                0.729    0.084    8.731    0.000    0.729    0.616
   .x8                0.422    0.084    5.039    0.000    0.422    0.413
   .x9                0.665    0.071    9.383    0.000    0.665    0.655
    visual            0.524    0.130    4.021    0.000    1.000    1.000
    textual           0.969    0.112    8.647    0.000    1.000    1.000
    speed             0.454    0.096    4.728    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="other-models-fixing-covariances-2" class="slide level2">
<h2>Other models: Fixing covariances</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">semPaths</span>(cfa_4, <span class="at">whatLabels =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="complex-models" class="slide level2">
<h2>Complex models</h2>
<p>We can put multiple latent variables, regressions, and covariances together to build complex models.</p>
<p>Here is a three factor mediation model:</p>
<ul>
<li class="fragment"><p><code>visual</code> is dependent on <code>textual</code> and <code>speed</code></p></li>
<li class="fragment"><p>The effect of <code>speed</code> on <code>visual</code> is partially mediated by <code>textual</code>.</p></li>
</ul>
</section>
<section id="complex-models-1" class="slide level2">
<h2>Complex models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>complex <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="st">   visual  =~ x1 + x2 + x3</span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">   textual =~ x4 + x5 + x6</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">   speed   =~ x7 + x8 + x9</span></span>
<span id="cb48-5"><a href="#cb48-5"></a></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="st">   visual  ~ textual + speed</span></span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="st">   textual ~ speed</span></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="st">'</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>complex <span class="ot">&lt;-</span> <span class="fu">sem</span>(complex, <span class="at">data=</span>HolzingerSwineford1939)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="complex-models-2" class="slide level2">
<h2>Complex models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">summary</span>(complex, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 33 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (BIC)         7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value RMSEA &lt;= 0.05                          0.001

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                1.000                               0.900    0.772
    x2                0.554    0.100    5.554    0.000    0.498    0.424
    x3                0.729    0.109    6.685    0.000    0.656    0.581
  textual =~                                                            
    x4                1.000                               0.990    0.852
    x5                1.113    0.065   17.014    0.000    1.102    0.855
    x6                0.926    0.055   16.703    0.000    0.917    0.838
  speed =~                                                              
    x7                1.000                               0.619    0.570
    x8                1.180    0.165    7.152    0.000    0.731    0.723
    x9                1.082    0.151    7.155    0.000    0.670    0.665

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~                                                              
    textual           0.321    0.067    4.776    0.000    0.354    0.354
    speed             0.538    0.130    4.152    0.000    0.370    0.370
  textual ~                                                             
    speed             0.452    0.124    3.654    0.000    0.283    0.283

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.549    0.114    4.833    0.000    0.549    0.404
   .x2                1.134    0.102   11.146    0.000    1.134    0.821
   .x3                0.844    0.091    9.317    0.000    0.844    0.662
   .x4                0.371    0.048    7.778    0.000    0.371    0.275
   .x5                0.446    0.058    7.642    0.000    0.446    0.269
   .x6                0.356    0.043    8.277    0.000    0.356    0.298
   .x7                0.799    0.081    9.823    0.000    0.799    0.676
   .x8                0.488    0.074    6.573    0.000    0.488    0.477
   .x9                0.566    0.071    8.003    0.000    0.566    0.558
   .visual            0.537    0.117    4.582    0.000    0.664    0.664
   .textual           0.901    0.106    8.496    0.000    0.920    0.920
    speed             0.384    0.086    4.451    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="complex-models-3" class="slide level2">
<h2>Complex models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">semPaths</span>(complex, <span class="at">whatLabels =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SEM_course_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="other-lavaan-features" class="slide level2">
<h2>Other lavaan Features</h2>
<p><code>lavaan</code> is highly customizable and contains many features useful for fitting complex structural equations.</p>
<div>
<ul>
<li class="fragment"><p>Alternate <strong>estimators</strong></p></li>
<li class="fragment"><p>Proper treatment of <strong>categorical variables</strong></p></li>
<li class="fragment"><p>Input using <strong>covariance matrices</strong></p></li>
<li class="fragment"><p><strong>Additional arguments</strong> for specifying models</p></li>
</ul>
</div>
</section>
<section id="alternate-estimators" class="slide level2">
<h2>Alternate estimators</h2>
<p><code>lavaan</code> defaults to using a full-information Maximum-Likelihood (ML) Estimator. This is the most efficient estimator available and can handle missing data (<code>missing=ml</code>).</p>
<p>We may want to specify alternate estimators if our data do not meet the assumptions for ML.</p>
<p>By adding the <code>estimator=</code> argument to our <code>cfa()</code>, <code>sem()</code>, or <code>lavaan()</code> call, we can choose another estimator.</p>
<p>Some useful choices:</p>
<ul>
<li class="fragment"><p><code>estimator="MLM"</code>: ML with robust errors and Satorra-Bentler test statistic.</p></li>
<li class="fragment"><p><code>estimator="WLSMV"</code>: Weighted least squares with mean and variance adjusted test statistic (needed for categorical endogenous variables).</p></li>
</ul>
<p>Example <code>sem()</code> call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">sem</span>(complex, <span class="at">data=</span>HolzingerSwineford1939, <span class="at">estimator=</span><span class="st">"MLM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                              Standard      Robust
  Test Statistic                                85.306      80.872
  Degrees of freedom                                24          24
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.055
    Satorra-Bentler correction                                    </code></pre>
</div>
</div>
</section>
<section id="categorical-variables" class="slide level2">
<h2>Categorical variables</h2>
<p>If you provide <code>lavaan</code> categorical data as an endogenous variable, it will automatically use a proper estimator (e.g.&nbsp;Diagonally Weighted Least Squares).</p>
<p>To specify an ordinal variable as categorical, you will want to make it an <em>ordered factor</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cat_var=</span><span class="fu">ordered</span>(cat_var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unordered categorical variables (factors) will need to be split into dummy variables prior to estimation.</p>
</section>
<section id="covariance-input-matrix" class="slide level2">
<h2>Covariance input matrix</h2>
<p>Here is example syntax from the <code>lavaan</code> tutorial page using the lower half of a covariance matrix combined with the <code>getCov()</code> function to create a full covariance matrix with variable names. Note the use of <code>sample.cov=</code> and <code>sample.nobs=</code> arguments to <code>sem()</code> instead of <code>data=</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>lower <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="st"> 11.834</span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="st">  6.947   9.364</span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="st">  6.819   5.091  12.532</span></span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="st">  4.783   5.028   7.495   9.986</span></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="st"> -3.839  -3.889  -3.841  -3.625  9.610</span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="st">-21.899 -18.831 -21.748 -18.775 35.522 450.288 '</span></span>
<span id="cb55-8"><a href="#cb55-8"></a></span>
<span id="cb55-9"><a href="#cb55-9"></a>wheaton.cov <span class="ot">&lt;-</span> </span>
<span id="cb55-10"><a href="#cb55-10"></a>    <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"anomia67"</span>, <span class="st">"powerless67"</span>, <span class="st">"anomia71"</span>, </span>
<span id="cb55-11"><a href="#cb55-11"></a>                            <span class="st">"powerless71"</span>, <span class="st">"education"</span>, <span class="st">"sei"</span>))</span>
<span id="cb55-12"><a href="#cb55-12"></a></span>
<span id="cb55-13"><a href="#cb55-13"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(wheaton.model, <span class="at">sample.cov =</span> wheaton.cov, <span class="at">sample.nobs =</span> <span class="dv">932</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="additional-arguments" class="slide level2">
<h2>Additional arguments</h2>
<p>Most of the time you will be fine with <code>lavaan</code>â€™s default settings.</p>
<p>However, there are many, many arguments you can give to <code>sem()</code>, <code>cfa()</code>, or <code>lavaan()</code> to adjust how models are estimated.</p>
<p>To see these arguments, view the help files using <code>?lavaan</code> and <code>?lavOptions</code>.</p>
</section>
<section id="help" class="slide level2">
<h2>Help</h2>
<p>You can find a more detailed <code>lavaan</code> tutorial and a number of resources via the <a href="http://lavaan.ugent.be/">official <code>lavaan</code> website</a>.</p>
<p>For troubleshooting, the <a href="https://groups.google.com/forum/#!forum/lavaan"><code>lavaan</code> Google group</a> is very active and frequented by the package authors.</p>
<p><code>lavaan</code> is in constant development, so you may want to check the <a href="https://github.com/yrosseel/lavaan">GitHub repository</a> for current issues or new features.</p>
<p>If you need a new feature or bug fix from the development version, you can install it using <code>install_github()</code> in the <code>devtools</code> package.</p>

<img src="Tropibio2.jpg" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://cibio-tropibio.pt/en/" class="uri">https://cibio-tropibio.pt/en/</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="SEM_course_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="SEM_course_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="SEM_course_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="SEM_course_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>